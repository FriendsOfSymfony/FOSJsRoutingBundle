!function(e,t){if("function"==typeof define&&define.amd)define([],t);else if("object"==typeof module&&module.exports)module.exports=t();else{var n=t();e.Routing=n.Routing,e.fos={Router:n.Router}}}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),o=function(){function o(t,n){e(this,o),this.context_=t||{base_url:"",prefix:"",host:"",scheme:""},this.setRoutes(n||{})}return n(o,[{key:"setRoutes",value:function(e){this.routes_=Object.freeze(e)}},{key:"getRoutes",value:function(){return this.routes_}},{key:"setBaseUrl",value:function(e){this.context_.base_url=e}},{key:"getBaseUrl",value:function(){return this.context_.base_url}},{key:"setPrefix",value:function(e){this.context_.prefix=e}},{key:"setScheme",value:function(e){this.context_.scheme=e}},{key:"getScheme",value:function(){return this.context_.scheme}},{key:"setHost",value:function(e){this.context_.host=e}},{key:"getHost",value:function(){return this.context_.host}},{key:"buildQueryParams",value:function(e,n,o){var i=this,r=void 0,s=new RegExp(/\[\]$/);if(n instanceof Array)n.forEach(function(n,r){s.test(e)?o(e,n):i.buildQueryParams(e+"["+("object"===("undefined"==typeof n?"undefined":t(n))?r:"")+"]",n,o)});else if("object"===("undefined"==typeof n?"undefined":t(n)))for(r in n)this.buildQueryParams(e+"["+r+"]",n[r],o);else o(e,n)}},{key:"getRoute",value:function(e){var t=this.context_.prefix+e;if(t in this.routes_)e=t;else if(!(e in this.routes_))throw new Error('The route "'+e+'" does not exist.');return this.routes_[e]}},{key:"generate",value:function(e,t,n){var o=this.getRoute(e),i=t||{},r=Object.assign({},i),s="",u=!0,f="";if(o.tokens.forEach(function(t){if("text"===t[0])return s=t[1]+s,void(u=!1);{if("variable"!==t[0])throw new Error('The token type "'+t[0]+'" is not supported.');var n=o.defaults&&t[3]in o.defaults;if(!1===u||!n||t[3]in i&&i[t[3]]!=o.defaults[t[3]]){var f=void 0;if(t[3]in i)f=i[t[3]],delete r[t[3]];else{if(!n){if(u)return;throw new Error('The route "'+e+'" requires the parameter "'+t[3]+'".')}f=o.defaults[t[3]]}var c=!0===f||!1===f||""===f;if(!c||!u){var a=encodeURIComponent(f).replace(/%2F/g,"/");"null"===a&&null===f&&(a=""),s=t[1]+a+s}u=!1}else n&&t[3]in r&&delete r[t[3]]}}),""===s&&(s="/"),o.hosttokens.forEach(function(e){var t=void 0;return"text"===e[0]?void(f=e[1]+f):void("variable"===e[0]&&(e[3]in i?(t=i[e[3]],delete r[e[3]]):o.defaults&&e[3]in o.defaults&&(t=o.defaults[e[3]]),f=e[1]+t+f))}),s=this.context_.base_url+s,o.requirements&&"_scheme"in o.requirements&&this.getScheme()!=o.requirements._scheme?s=o.requirements._scheme+"://"+(f||this.getHost())+s:"undefined"!=typeof o.schemes&&"undefined"!=typeof o.schemes[0]&&this.getScheme()!==o.schemes[0]?s=o.schemes[0]+"://"+(f||this.getHost())+s:f&&this.getHost()!==f?s=this.getScheme()+"://"+f+s:n===!0&&(s=this.getScheme()+"://"+this.getHost()+s),Object.keys(r).length>0){var c=void 0,a=[],l=function(e,t){t="function"==typeof t?t():t,t=null===t?"":t,a.push(encodeURIComponent(e)+"="+encodeURIComponent(t))};for(c in r)this.buildQueryParams(c,r[c],l);s=s+"?"+a.join("&").replace(/%20/g,"+")}return s}}],[{key:"getInstance",value:function(){return i}},{key:"setData",value:function(e){var t=o.getInstance();t.setBaseUrl(e.base_url),t.setRoutes(e.routes),"prefix"in e&&t.setPrefix(e.prefix),t.setHost(e.host),t.setScheme(e.scheme)}}]),o}();o.Route,o.Context;var i=new o;return{Router:o,Routing:i}});